<tr>
  <td class="label"><label>Sous-type : </label></td>
  <td><%= f.select :tool_subtype_id_equals, [["Tous",""]]+(ToolSubtype.for_softwares.collect {|s| [ s.name, "#{s.id}" ] }.sort{|a,b| a <=> b}), {:selected => params[:search] ? "#{params[:search][:tool_subtype_id_equals]}" : nil}, :class => "select_refine_search" %></td>
</tr>
<tr>
  <td class="label"><label>Laboratoire : </label></td>
  <td><%= f.select :laboratory_id_equals, [["Tous",""]]+(Laboratory.all.collect {|s| [ s.name, "#{s.id}" ] }.sort{|a,b| a <=> b}), {:selected => params[:search] ? "#{params[:search][:laboratory_id_equals]}" : nil}, :class => "select_refine_search" %></td>
</tr>
<% if current_user %>
  <tr>
    <td class="label"><label>Entit√© de recherche : </label></td>
    <td><%= f.select :correspondents_search_entity_id_equals, (@entities ? [["Tous",""]]+(@entities.collect {|c| [ truncate(c.name, :length => 70), "#{c.id}"] }.sort{|a,b| a <=> b}) : [["Tous",""]]+(SearchEntity.all.collect {|c| [ c.name, "#{c.id}"] }).sort{|a,b| a <=> b}), {:selected => params[:search] ? "#{params[:search][:correspondents_search_entity_id_equals]}" : nil}, :class => "select_refine_search" %></td>
  </tr>
  <tr>
    <td class="label"><label>Correspondant : </label></td>
    <td><%= f.select :correspondents_id_equals, (@correspondents ? [["Tous",""]]+(@correspondents.collect {|c| [ c.name, "#{c.id}"] }.sort{|a,b| a <=> b}) : [["Tous",""]]+(User.correspondents.collect {|c| [ c.name, "#{c.id}"] }.sort{|a,b| a <=> b})), {:selected => params[:search] ? "#{params[:search][:correspondents_id_equals]}" : nil}, :class => "select_refine_search" %></td>
  </tr>
<% end %>
<tr>
  <td class="label"><label>Marque/Constructeur : </label></td>
  <td><%= f.select :brand_equals, [["Tous",""]]+((Tool.all.collect(&:brand).collect {|b| [ truncate(b, :length => 70), b ] }.delete_if {|a,b| a.nil? || b.nil?}.uniq).sort{|a,b| a <=> b}), {:selected => params[:search] ? params[:search][:brand_equals] : nil}, :class => "select_refine_search" %></td>
</tr>
<tr>
  <td class="label"><label>Statut : </label></td>
  <td><%= f.select :software_statuses_id_equals, [["Tous",""]]+(SoftwareStatus.all.collect {|s| [ s.name, "#{s.id}" ] }.sort{|a,b| a <=> b}), {:selected => params[:search] ? "#{params[:search][:software_statuses_id_equals]}" : nil}, :class => "select_refine_search" %></td>
</tr>
<tr>
  <td class="label"><label>Domaine d'application : </label></td>
  <td><%= f.select :software_application_domains_id_equals, [["Tous",""]]+(SoftwareApplicationDomain.all.collect {|d| [ d.application_domain, "#{d.id} "] }.sort{|a,b| a <=> b}), {:selected => params[:search] ? "#{params[:search][:software_application_domains_id_equals]}" : nil}, :class => "select_refine_search" %></td>
</tr>